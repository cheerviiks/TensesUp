<div class="tense">
    <h2>Past Perfect</h2>
    <p class="intro">Past Perfect — это прошедшее совершенное время, которое показывает, что одно действие в прошлом произошло раньше другого. Мы используем его, чтобы показать порядок событий в прошлом.</p>

    <h3>Когда именно используется Past Perfect</h3>
    <h4>1. Действие произошло раньше другого действия в прошлом</h4>
    <p class="note">Когда нужно показать, что одно действие случилось до другого в прошлом.</p>
    <div class="examples">
        <p>When I arrived at the party, my friends <strong>had already left</strong>.<em> — Когда я прибыл на вечеринку, мои друзья уже ушли (сначала они ушли, потом я прибыл).</em></p>
        <p>She realized she <strong>had forgotten</strong> her keys.<em> — Она поняла, что забыла свои ключи (сначала забыла, потом поняла).</em></p>
        <p>After they <strong>had finished</strong> dinner, they watched TV.<em> — После того как они закончили ужинать, они посмотрели телевизор.</em></p>
    </div>
    
    <h4>2. Опыт до определённого момента в прошлом</h4>
    <p class="note">Действия, которые произошли до какого-то момента в прошлом.</p>
    <div class="examples">
        <p>By the time I was 20, I <strong>had already visited</strong> 10 countries.<em> — К тому времени, когда мне было 20, я уже посетил 10 стран.</em></p>
        <p>She <strong>had never seen</strong> snow before she moved to Canada.<em> — Она никогда не видела снег до того, как переехала в Канаду.</em></p>
        <p>Before 2020, I <strong>had worked</strong> at three different companies.<em> — До 2020 года я работал в трёх разных компаниях.</em></p>
    </div>
    
    <h4>3. Причина и следствие в прошлом</h4>
    <p class="note">Показывает причину того, что произошло в прошлом.</p>
    <div class="examples">
        <p>He was tired because he <strong>had worked</strong> all day.<em> — Он устал, потому что работал весь день (работал → устал).</em></p>
        <p>She couldn't enter the house because she <strong>had lost</strong> her keys.<em> — Она не могла войти в дом, потому что потеряла ключи.</em></p>
        <p>They were happy because they <strong>had won</strong> the game.<em> — Они были счастливы, потому что выиграли игру.</em></p>
    </div>

    <h3>Ключевое отличие: Past Perfect vs Past Simple</h3>
    <table>
        <thead>
            <tr>
                <th>Past Perfect (раньше)</th>
                <th>Past Simple (позже/одновременно)</th>
                <th>Разница</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td data-label="Past Perfect">When I arrived, she <strong>had already left</strong>.<em> (ушла раньше, чем я прибыл)</em></td>
                <td data-label="Past Simple">When I arrived, she <strong>left</strong>.<em> (ушла в тот момент, когда я прибыл)</em></td>
                <td data-label="Разница">Действие раньше vs действие одновременно</td>
            </tr>
            <tr>
                <td data-label="Past Perfect">After he <strong>had finished</strong> his homework, he watched TV.<em> (сначала закончил, потом смотрел)</em></td>
                <td data-label="Past Simple">He finished his homework and watched TV.<em> (просто последовательность)</em></td>
                <td data-label="Разница">Чёткий порядок vs простая последовательность</td>
            </tr>
            <tr>
                <td data-label="Past Perfect">She was sad because her cat <strong>had died</strong>.<em> (кот умер раньше, чем она стала грустной)</em></td>
                <td data-label="Past Simple">Her cat died and she was sad.<em> (два события одно за другим)</em></td>
                <td data-label="Разница">Причина и следствие vs просто события</td>
            </tr>
            <tr>
                <td data-label="Past Perfect">By 2010, I <strong>had graduated</strong> from university.<em> (закончил до 2010)</em></td>
                <td data-label="Past Simple">I graduated in 2010.<em> (закончил в 2010)</em></td>
                <td data-label="Разница">До определённого момента vs в определённый момент</td>
            </tr>
        </tbody>
    </table>

    <h3>1. Утвердительные предложения</h3>
    <table>
        <thead>
            <tr>
                <th>Лицо</th>
                <th>Формула</th>
                <th>Пример</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td data-label="Лицо">I / You / He / She / It / We / They</td>
                <td data-label="Формула">had + V3</td>
                <td data-label="Пример">I had finished my work.</td>
            </tr>
            <tr>
                <td data-label="Лицо">I / You / He / She / It / We / They</td>
                <td data-label="Формула">'d + V3 (сокращение)</td>
                <td data-label="Пример">She'd already left.</td>
            </tr>
        </tbody>
    </table>
    
    <p class="note">V3 — третья форма глагола. Had одинаков для всех лиц! Никаких окончаний не добавляется.</p>

    <h3>2. Отрицательные предложения</h3>
    <table>
        <thead>
            <tr>
                <th>Лицо</th>
                <th>Формула</th>
                <th>Пример</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td data-label="Лицо">I / You / He / She / It / We / They</td>
                <td data-label="Формула">had not + V3</td>
                <td data-label="Пример">I had not seen that film.</td>
            </tr>
            <tr>
                <td data-label="Лицо">I / You / He / She / It / We / They</td>
                <td data-label="Формула">hadn't + V3 (сокращение)</td>
                <td data-label="Пример">He hadn't finished his homework.</td>
            </tr>
        </tbody>
    </table>

    <h3>3. Вопросы</h3>
    <table>
        <thead>
            <tr>
                <th>Тип</th>
                <th>Формула</th>
                <th>Пример</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td data-label="Тип">Общий</td>
                <td data-label="Формула">Had + subject + V3?</td>
                <td data-label="Пример">Had you seen that film before?</td>
            </tr>
            <tr>
                <td data-label="Тип">Специальный</td>
                <td data-label="Формула">What/Why/How + had + subject + V3?</td>
                <td data-label="Пример">Why had she left early?</td>
            </tr>
        </tbody>
    </table>

    <h3>4. Слова-маркеры и выражения</h3>
    <h4>Показатели порядка действий:</h4>
    <div class="examples">
        <p>already — уже (раньше)</p>
        <p>before — до того как</p>
        <p>after — после того как</p>
        <p>when — когда</p>
        <p>by the time — к тому времени, когда</p>
    </div>
    
    <h4>Показатели времени:</h4>
    <div class="examples">
        <p>by 5 o'clock — к 5 часам</p>
        <p>by yesterday — к вчерашнему дню</p>
        <p>by last week — к прошлой неделе</p>
        <p>by the end of — к концу</p>
    </div>
    
    <h4>Частые конструкции:</h4>
    <div class="examples">
        <p>... because ... had ... — ... потому что ... (сделал раньше)</p>
        <p>After ... had ... — После того как ...</p>
        <p>Before ... had ... — До того как ...</p>
        <p>When ... had ... — Когда ... (уже сделал)</p>
    </div>

    <h3>Сравнение трёх прошедших времён</h3>
    <table>
        <thead>
            <tr>
                <th>Past Perfect</th>
                <th>Past Simple</th>
                <th>Past Continuous</th>
                <th>Пример</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td data-label="Past Perfect">Самое раннее действие</td>
                <td data-label="Past Simple">Основное действие</td>
                <td data-label="Past Continuous">Длительное действие в фоне</td>
                <td data-label="Пример">When I arrived (Past Simple), she had already cooked dinner (Past Perfect) and was setting the table (Past Continuous).</td>
            </tr>
            <tr>
                <td data-label="Past Perfect">had + V3</td>
                <td data-label="Past Simple">V2 или V+ed</td>
                <td data-label="Past Continuous">was/were + V-ing</td>
                <td data-label="Пример">She had finished (PP), then she left (PS) while it was raining (PC).</td>
            </tr>
        </tbody>
    </table>

    <h3>Типичная ошибка: когда НЕ нужно Past Perfect</h3>
    <div class="examples">
        <p>❌ <strong>Не нужно</strong>, если события идут по порядку: I woke up, had breakfast, and went to work.</p>
        <p>✅ <strong>Нужно</strong>, когда порядок не очевиден: When I arrived, she had already left.</p>
        <p>❌ <strong>Не нужно</strong> с "ago": I saw him two days ago. (НЕ: I had seen him two days ago)</p>
        <p>✅ <strong>Нужно</strong> с "before": I had seen him before that day.</p>
    </div>

    <h3>Упражнения</h3>
    
    <button class="start-btn" onclick="toggleExercise('exercise1')">Упражнение 1 — выбери нужную форму</button>
    <div id="exercise1" class="exercise">
        
<div class="task">
    <p>1. When I arrived at the station, the train ___ (already/leave).</p>
    <button onclick="check(this,true)">had already left</button>
    <button onclick="check(this,false)">already left</button>
    <button onclick="check(this,false)">has already left</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>2. She ___ (not finish) her homework when her friends called.</p>
    <button onclick="check(this,true)">had not finished</button>
    <button onclick="check(this,false)">did not finish</button>
    <button onclick="check(this,false)">not finished</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>3. ___ you ___ (see) that film before yesterday?</p>
    <button onclick="check(this,true)">Had / seen</button>
    <button onclick="check(this,false)">Did / see</button>
    <button onclick="check(this,false)">Have / seen</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>4. After they ___ (eat) dinner, they went for a walk.</p>
    <button onclick="check(this,true)">had eaten</button>
    <button onclick="check(this,false)">ate</button>
    <button onclick="check(this,false)">have eaten</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>5. He was tired because he ___ (work) for 12 hours.</p>
    <button onclick="check(this,true)">had worked</button>
    <button onclick="check(this,false)">worked</button>
    <button onclick="check(this,false)">has worked</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>6. By the time I was 25, I ___ (visit) 15 countries.</p>
    <button onclick="check(this,true)">had visited</button>
    <button onclick="check(this,false)">visited</button>
    <button onclick="check(this,false)">have visited</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>7. She realized she ___ (forget) her passport at home.</p>
    <button onclick="check(this,true)">had forgotten</button>
    <button onclick="check(this,false)">forgot</button>
    <button onclick="check(this,false)">has forgotten</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>8. Before yesterday, I ___ (never/try) sushi.</p>
    <button onclick="check(this,true)">had never tried</button>
    <button onclick="check(this,false)">never tried</button>
    <button onclick="check(this,false)">have never tried</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>9. The movie ___ (already/start) when we got to the cinema.</p>
    <button onclick="check(this,true)">had already started</button>
    <button onclick="check(this,false)">already started</button>
    <button onclick="check(this,false)">has already started</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>10. Why ___ he ___ (leave) before I arrived?</p>
    <button onclick="check(this,true)">had / left</button>
    <button onclick="check(this,false)">did / leave</button>
    <button onclick="check(this,false)">has / left</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>11. After she ___ (finish) her degree, she got a job.</p>
    <button onclick="check(this,true)">had finished</button>
    <button onclick="check(this,false)">finished</button>
    <button onclick="check(this,false)">has finished</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>12. They were hungry because they ___ (not eat) all day.</p>
    <button onclick="check(this,true)">had not eaten</button>
    <button onclick="check(this,false)">did not eat</button>
    <button onclick="check(this,false)">not eaten</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>13. How long ___ you ___ (know) her before you got married?</p>
    <button onclick="check(this,true)">had / known</button>
    <button onclick="check(this,false)">did / know</button>
    <button onclick="check(this,false)">have / known</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>14. The shop ___ (close) by the time we got there.</p>
    <button onclick="check(this,true)">had closed</button>
    <button onclick="check(this,false)">closed</button>
    <button onclick="check(this,false)">has closed</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>15. I ___ (never/see) such a beautiful sunset before that day.</p>
    <button onclick="check(this,true)">had never seen</button>
    <button onclick="check(this,false)">never saw</button>
    <button onclick="check(this,false)">have never seen</button>
    <p class="result"></p>
</div>

    </div>
    
    <button class="start-btn" onclick="toggleExercise('exercise2')">
        Упражнение 2 — установите правильный порядок слов
    </button>

    <div id="exercise2" class="exercise">
    
<div class="task">
    <p>1. Когда я прибыл на станцию, поезд уже ушёл.</p>
    <div class="words">
        <button onclick="addWord(this)">the</button>
        <button onclick="addWord(this)">arrived</button>
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">I</button>
        <button onclick="addWord(this)">When</button>
        <button onclick="addWord(this)">train</button>
        <button onclick="addWord(this)">station</button>
        <button onclick="addWord(this)">already</button>
        <button onclick="addWord(this)">at</button>
        <button onclick="addWord(this)">left</button>
        <button onclick="addWord(this)">.</button>
        <button onclick="addWord(this)">the</button>
    </div>
    <p class="sentence" data-answer="When I arrived at the station , the train had already left ."></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>2. Она не закончила домашнее задание, когда позвонили её друзья.</p>
    <div class="words">
        <button onclick="addWord(this)">her</button>
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">She</button>
        <button onclick="addWord(this)">homework</button>
        <button onclick="addWord(this)">friends</button>
        <button onclick="addWord(this)">called</button>
        <button onclick="addWord(this)">not</button>
        <button onclick="addWord(this)">her</button>
        <button onclick="addWord(this)">when</button>
        <button onclick="addWord(this)">finished</button>
        <button onclick="addWord(this)">.</button>
    </div>
    <p class="sentence" data-answer="She had not finished her homework when her friends called ."></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>3. Ты видел этот фильм до вчерашнего дня?</p>
    <div class="words">
        <button onclick="addWord(this)">seen</button>
        <button onclick="addWord(this)">film</button>
        <button onclick="addWord(this)">that</button>
        <button onclick="addWord(this)">Had</button>
        <button onclick="addWord(this)">yesterday</button>
        <button onclick="addWord(this)">you</button>
        <button onclick="addWord(this)">before</button>
        <button onclick="addWord(this)">?</button>
    </div>
    <p class="sentence" data-answer="Had you seen that film before yesterday ?"></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>4. После того как они поужинали, они пошли на прогулку.</p>
    <div class="words">
        <button onclick="addWord(this)">After</button>
        <button onclick="addWord(this)">eaten</button>
        <button onclick="addWord(this)">dinner</button>
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">they</button>
        <button onclick="addWord(this)">walk</button>
        <button onclick="addWord(this)">for</button>
        <button onclick="addWord(this)">a</button>
        <button onclick="addWord(this)">went</button>
        <button onclick="addWord(this)">.</button>
    </div>
    <p class="sentence" data-answer="After they had eaten dinner , they went for a walk ."></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>5. Он устал, потому что работал 12 часов.</p>
    <div class="words">
        <button onclick="addWord(this)">because</button>
        <button onclick="addWord(this)">tired</button>
        <button onclick="addWord(this)">hours</button>
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">for</button>
        <button onclick="addWord(this)">12</button>
        <button onclick="addWord(this)">was</button>
        <button onclick="addWord(this)">He</button>
        <button onclick="addWord(this)">worked</button>
        <button onclick="addWord(this)">.</button>
    </div>
    <p class="sentence" data-answer="He was tired because he had worked for 12 hours ."></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>6. К тому времени, когда мне было 25, я посетил 15 стран.</p>
    <div class="words">
        <button onclick="addWord(this)">25</button>
        <button onclick="addWord(this)">time</button>
        <button onclick="addWord(this)">visited</button>
        <button onclick="addWord(this)">I</button>
        <button onclick="addWord(this)">was</button>
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">By</button>
        <button onclick="addWord(this)">15</button>
        <button onclick="addWord(this)">the</button>
        <button onclick="addWord(this)">countries</button>
        <button onclick="addWord(this)">.</button>
    </div>
    <p class="sentence" data-answer="By the time I was 25 , I had visited 15 countries ."></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>7. Она поняла, что забыла свой паспорт дома.</p>
    <div class="words">
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">realized</button>
        <button onclick="addWord(this)">her</button>
        <button onclick="addWord(this)">home</button>
        <button onclick="addWord(this)">She</button>
        <button onclick="addWord(this)">passport</button>
        <button onclick="addWord(this)">at</button>
        <button onclick="addWord(this)">forgotten</button>
        <button onclick="addWord(this)">.</button>
    </div>
    <p class="sentence" data-answer="She realized she had forgotten her passport at home ."></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>8. Магазин уже закрылся к тому времени, когда мы туда добрались.</p>
    <div class="words">
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">shop</button>
        <button onclick="addWord(this)">we</button>
        <button onclick="addWord(this)">The</button>
        <button onclick="addWord(this)">got</button>
        <button onclick="addWord(this)">closed</button>
        <button onclick="addWord(this)">there</button>
        <button onclick="addWord(this)">time</button>
        <button onclick="addWord(this)">by</button>
        <button onclick="addWord(this)">the</button>
        <button onclick="addWord(this)">.</button>
    </div>
    <p class="sentence" data-answer="The shop had closed by the time we got there ."></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>9. Почему он ушёл до того, как я прибыл?</p>
    <div class="words">
        <button onclick="addWord(this)">I</button>
        <button onclick="addWord(this)">arrived</button>
        <button onclick="addWord(this)">he</button>
        <button onclick="addWord(this)">Why</button>
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">before</button>
        <button onclick="addWord(this)">left</button>
        <button onclick="addWord(this)">?</button>
    </div>
    <p class="sentence" data-answer="Why had he left before I arrived ?"></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

<div class="task">
    <p>10. Они были голодны, потому что не ели весь день.</p>
    <div class="words">
        <button onclick="addWord(this)">because</button>
        <button onclick="addWord(this)">all</button>
        <button onclick="addWord(this)">eaten</button>
        <button onclick="addWord(this)">hungry</button>
        <button onclick="addWord(this)">had</button>
        <button onclick="addWord(this)">day</button>
        <button onclick="addWord(this)">They</button>
        <button onclick="addWord(this)">were</button>
        <button onclick="addWord(this)">not</button>
        <button onclick="addWord(this)">.</button>
    </div>
    <p class="sentence" data-answer="They were hungry because they had not eaten all day ."></p>
    <button onclick="checkSentence(this)">Проверить</button>
    <button onclick="clearOrder(this)">Стереть</button>
    <p class="result"></p>
</div>

    </div>

    <button class="start-btn" onclick="toggleExercise('exercise3')">
        Упражнение 3 — впишите слово в правильной форме
    </button>

    <div id="exercise3" class="exercise">
        
<div class="task">
    <p>1. When we got to the cinema, the film <input type="text" data-answer="had already started"> (already/start).</p>
</div>

<div class="task">
    <p>2. She <input type="text" data-answer="had never been"> (never/be) to London before last year.</p>
</div>

<div class="task">
    <p>3. <input type="text" data-answer="Had you finished"> (you/finish) your work when I called?</p>
</div>

<div class="task">
    <p>4. After he <input type="text" data-answer="had graduated"> (graduate), he found a good job.</p>
</div>

<div class="task">
    <p>5. I couldn't buy the book because I <input type="text" data-answer="had lost"> (lose) my wallet.</p>
</div>

<div class="task">
    <p>6. By 2020, they <input type="text" data-answer="had been"> (be) married for 10 years.</p>
</div>

<div class="task">
    <p>7. He was upset because his team <input type="text" data-answer="had lost"> (lose) the game.</p>
</div>

<div class="task">
    <p>8. Before yesterday, I <input type="text" data-answer="had never seen"> (never/see) that man before.</p>
</div>

<div class="task">
    <p>9. The children <input type="text" data-answer="had already eaten"> (already/eat) when we arrived home.</p>
</div>

<div class="task">
    <p>10. Why <input type="text" data-answer="had she left"> (she/leave) so early?</p>
</div>

<div class="task">
    <p>11. After the rain <input type="text" data-answer="had stopped"> (stop), we went outside.</p>
</div>

<div class="task">
    <p>12. She knew the answer because she <input type="text" data-answer="had studied"> (study) all night.</p>
</div>

<div class="task">
    <p>13. By 8 PM yesterday, I <input type="text" data-answer="had finished"> (finish) all my work.</p>
</div>

<div class="task">
    <p>14. They were late because they <input type="text" data-answer="had missed"> (miss) the bus.</p>
</div>

<div class="task">
    <p>15. I <input type="text" data-answer="had already read"> (already/read) that book before you recommended it.</p>
</div>

        <button onclick="checkInputs('exercise3')">Проверить</button>
        <button onclick="clearInputs('exercise3')">Стереть</button>
    </div>
</div>